---
import type { Quote } from "../data/quotes"

interface Props {
  quote: Quote
}

const { quote } = Astro.props

const platformIcons: Record<string, string> = {
  reddit: "ðŸ”´",
  lifehacker: "âš¡",
  appaddict: "ðŸ“±",
}

const colorClasses: Record<
  string,
  { border: string; bg: string; accent: string; dark: string }
> = {
  blue: {
    border: "border-blue-400",
    bg: "bg-blue-50",
    accent: "text-blue-500",
    dark: "dark:bg-blue-950/30 dark:text-blue-300",
  },
  pink: {
    border: "border-pink-400",
    bg: "bg-pink-50",
    accent: "text-pink-500",
    dark: "dark:bg-pink-950/30 dark:text-pink-300",
  },
  purple: {
    border: "border-purple-400",
    bg: "bg-purple-50",
    accent: "text-purple-500",
    dark: "dark:bg-purple-950/30 dark:text-purple-300",
  },
}

const colors = colorClasses[quote.accentColor] || colorClasses.blue

// Get initials for avatar
const getInitials = (name: string) => {
  return name
    .split(" ")
    .map((n) => n[0])
    .join("")
    .substring(0, 2)
    .toUpperCase()
}

// Get avatar color
const getAvatarColor = () => {
  if (quote.accentColor === "blue") return "bg-blue-500"
  if (quote.accentColor === "pink") return "bg-pink-500"
  return "bg-purple-500"
}
---

<div class="quote-card">
  {
    quote.variant === 1 && (
      <div class="group relative flex flex-col items-center justify-center gap-4 rounded-lg bg-gradient-to-br from-slate-100 to-slate-50 p-8 text-center dark:from-slate-900 dark:to-slate-800 md:p-12">
        {/* Decorative quote mark */}
        <div class={`absolute -top-4 left-0 text-8xl font-bold opacity-20 transition-opacity group-hover:opacity-30 ${colors.accent}`}>
          "
        </div>

        <p class="relative z-10 text-2xl font-serif italic leading-relaxed text-slate-900 dark:text-slate-100 md:text-3xl">
          {quote.text}
        </p>

        <div class="relative z-10 flex flex-col items-center gap-2 pt-4">
          <div class="flex items-center gap-2 text-slate-600 dark:text-slate-400">
            <span class="text-xl">{platformIcons[quote.platform]}</span>
            <span class="text-sm font-medium">{quote.attribution}</span>
          </div>
          <a
            href={quote.url}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-slate-500 underline transition-colors hover:text-slate-700 dark:text-slate-500 dark:hover:text-slate-300"
          >
            View on {quote.platform}
          </a>
        </div>
      </div>
    )
  }

  {
    quote.variant === 2 && (
      <div
        class={`group relative flex flex-col gap-4 rounded-lg border-l-4 p-6 transition-all duration-300 ${colors.bg} ${colors.border} hover:shadow-lg hover:-rotate-1 dark:border-opacity-50 ${colors.dark}`}
      >
        <div
          class={`absolute -top-2 -left-3 text-4xl font-bold opacity-15 transition-opacity group-hover:opacity-25 ${colors.accent}`}
        >
          "
        </div>

        <p class="relative z-10 text-base leading-relaxed text-slate-900 dark:text-slate-100">
          {quote.text}
        </p>

        <div class="flex items-center justify-between pt-2">
          <div class="flex items-center gap-2">
            <span class="text-lg">{platformIcons[quote.platform]}</span>
            <span class="text-sm font-medium text-slate-700 dark:text-slate-300">
              {quote.attribution}
            </span>
          </div>
          <a
            href={quote.url}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-slate-500 transition-colors hover:text-slate-700 dark:text-slate-500 dark:hover:text-slate-300"
            title="View original quote"
          >
            â†—
          </a>
        </div>
      </div>
    )
  }

  {
    quote.variant === 3 && (
      <div
        class={`group relative flex items-start gap-4 rounded-lg p-5 transition-all duration-300 ${colors.bg} hover:shadow-md ${colors.dark}`}
      >
        {/* Avatar circle placeholder */}
        <div
          class={`mt-1 flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full font-semibold text-white ${getAvatarColor()}`}
        >
          {getInitials(quote.attribution)}
        </div>

        <div class="flex-1">
          <p class="text-sm leading-relaxed text-slate-900 dark:text-slate-100">
            {quote.text}
          </p>
          <div class="mt-3 flex items-center justify-between">
            <span class="text-xs font-medium text-slate-600 dark:text-slate-400">
              {quote.attribution}
            </span>
            <a
              href={quote.url}
              target="_blank"
              rel="noopener noreferrer"
              class="text-xs text-slate-500 transition-colors hover:text-slate-700 dark:text-slate-500 dark:hover:text-slate-300"
            >
              {platformIcons[quote.platform]}
            </a>
          </div>
        </div>
      </div>
    )
  }

  {
    quote.variant === 4 && (
      <div
        class={`group relative rounded-lg border-l-4 p-6 transition-all duration-300 ${colors.bg} ${colors.border} hover:shadow-lg dark:border-opacity-50 ${colors.dark}`}
      >
        <div class="flex flex-col gap-4">
          {/* Quote mark accent */}
          <div
            class={`flex h-8 w-8 items-center justify-center rounded-full opacity-30 transition-opacity group-hover:opacity-50 ${
              quote.accentColor === "blue"
                ? "bg-blue-200 dark:bg-blue-900"
                : quote.accentColor === "pink"
                  ? "bg-pink-200 dark:bg-pink-900"
                  : "bg-purple-200 dark:bg-purple-900"
            }`}
          >
            <span class={`text-lg font-bold ${colors.accent}`}>"</span>
          </div>

          {/* Quote text */}
          <blockquote class="text-base leading-relaxed text-slate-900 dark:text-slate-100">
            {quote.text}
          </blockquote>

          {/* Attribution */}
          <div class="flex items-center justify-between border-t border-slate-200 pt-4 dark:border-slate-700">
            <div>
              <p class="font-semibold text-slate-900 dark:text-slate-100">
                {quote.attribution}
              </p>
              <div class="flex items-center gap-1 pt-1">
                <span class="text-sm">{platformIcons[quote.platform]}</span>
                <span class="text-xs capitalize text-slate-600 dark:text-slate-400">
                  {quote.platform}
                </span>
              </div>
            </div>
            <a
              href={quote.url}
              target="_blank"
              rel="noopener noreferrer"
              class="text-slate-400 transition-colors hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300"
              title="View original quote"
            >
              <span class="text-xl">â†—</span>
            </a>
          </div>
        </div>
      </div>
    )
  }
</div>

<style>
  .quote-card {
    animation: slideUpFade 0.6s ease-out both;
  }

  @keyframes slideUpFade {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
